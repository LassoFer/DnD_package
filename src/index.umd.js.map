{"version":3,"file":"index.umd.js","sources":["DragAndDrop/DandDMethods.js","DragAndDrop/DragAndDrop.js"],"sourcesContent":["import { createRef } from 'react';\r\n\r\n/////First render methods////////\r\n\r\nexport const createElementReferences = (list_, setList) => {\r\n  if (!list_ || list_.length === 0) return;\r\n  setList(\r\n    list_.map((l) => {\r\n      l['ref'] = createRef();\r\n      l['x'] = 0;\r\n      l['y'] = 0;\r\n      return l;\r\n    }),\r\n  );\r\n};\r\n\r\n////Starting dragging////\r\n\r\nexport const initialPos = (ref, draggedEl, contRef) => {\r\n  const coords = ref.current.getBoundingClientRect();\r\n  const coordsCont = contRef.current.getBoundingClientRect();\r\n  draggedEl.x = coords.x - coordsCont.x;\r\n  draggedEl.y = coords.y - coordsCont.y;\r\n};\r\n\r\nexport const addEmpty = (ref, draggedIndex, draggedEl, list) => {\r\n  list.splice(draggedIndex, 0, {\r\n    _id: 'empty',\r\n    extraStyle: {\r\n      width: ref.current.offsetWidth,\r\n      height: ref.current.offsetHeight,\r\n    },\r\n  });\r\n  draggedEl['extraStyle'] = {\r\n    width: ref.current.offsetWidth,\r\n    height: ref.current.offsetHeight,\r\n  };\r\n};\r\n\r\n////Moving methods////\r\n\r\nexport const moveElement = (draggedElement, evt) => {\r\n  let difx = draggedElement.x + evt.pageX - draggedElement.mouseDown.pageX;\r\n  let dify = draggedElement.y + evt.pageY - draggedElement.mouseDown.pageY;\r\n  draggedElement.ref.current.style.transform = 'translate(' + difx + 'px,' + dify + 'px)';\r\n};\r\n\r\nexport const moveElements = (draggedElement, setDraggedElement, list, setList, draggedIndex, i) => {\r\n  draggedElement['enable'] = true;\r\n  setDraggedElement(Object.assign(draggedElement));\r\n  let elements = list.splice(draggedIndex, 1);\r\n  list.splice(i, 0, ...elements);\r\n  setList([...list]);\r\n};\r\n\r\nexport const isInside = (ref, el) => {\r\n  let coords = el.ref?.current.getBoundingClientRect();\r\n  let refCoords = ref.current.getBoundingClientRect();\r\n  let middleY = refCoords.y + refCoords.height / 2;\r\n  let middleX = refCoords.x + refCoords.width / 2;\r\n  let elCoords = {\r\n    x: coords.x,\r\n    xM: coords.width,\r\n    y: coords.y,\r\n    yM: coords.bottom,\r\n  };\r\n\r\n  let inside =\r\n    middleX > elCoords.x && middleX < elCoords.x + elCoords.xM && middleY > elCoords.y && middleY < elCoords.yM;\r\n  return inside;\r\n};\r\n\r\nexport const setTemp = (draggedElement, setDraggedElement) =>\r\n  setTimeout(() => {\r\n    draggedElement['enable'] = false;\r\n    setDraggedElement(Object.assign(draggedElement));\r\n  }, 200);\r\n","import { useAutoAnimate } from '@formkit/auto-animate/react';\r\nimport { useEffect, useState } from 'react';\r\nimport {\r\n  addEmpty,\r\n  createElementReferences,\r\n  initialPos,\r\n  isInside,\r\n  moveElement,\r\n  moveElements,\r\n  setTemp,\r\n} from './DandDMethods';\r\n\r\nexport default function DragAndDrop({ duration, list_, contRef, elementclassName, containerclassName }) {\r\n  const [list, setList] = useState(list_);\r\n  const [draggedElement, setDraggedElement] = useState(undefined);\r\n  const [parent, enableAnimations] = useAutoAnimate({ duration: duration });\r\n\r\n  useEffect(() => {\r\n    createElementReferences(list_, setList);\r\n  }, [list_]);\r\n\r\n  useEffect(() => {\r\n    if (!draggedElement) return;\r\n\r\n    const handleMouseMove = (evt) => {\r\n      moveElement(draggedElement, evt);\r\n      moveEmptyElement(draggedElement.ref, evt);\r\n    };\r\n\r\n    const handleMouseUp = (evt) => {\r\n      handleDrop(list.findIndex((el) => el._id === 'empty'));\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n\r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n  }, [draggedElement]);\r\n\r\n  const moveEmptyElement = (ref) => {\r\n    let draggedEl = list.find((el) => el.dragged);\r\n    let draggedIndex = list.findIndex((el) => el._id === 'empty');\r\n\r\n    for (let i = 0; i < list.length; i++) {\r\n      let el = list[i];\r\n      if (!draggedElement.enable && el !== draggedEl && el._id !== 'empty' && isInside(ref, el)) {\r\n        moveElements(draggedElement, setDraggedElement, list, setList, draggedIndex, i); //set enable animtion to false and set new state\r\n        setTemp(draggedElement, setDraggedElement); //Does not let to move empty until animation is finished\r\n        break;\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDrop = (draggedIndex) => {\r\n    let newList = list.filter((rd) => rd._id !== 'empty');\r\n    newList.splice(draggedIndex, 0, draggedElement);\r\n    setDraggedElement(undefined);\r\n    setList([...newList]);\r\n  };\r\n\r\n  const handleDrag = async (mouseDown, ref) => {\r\n    mouseDown.stopPropagation();\r\n    let draggedEl = list.find((el) => el.ref === ref);\r\n    let draggedIndex = list.findIndex((el) => el.ref === ref);\r\n    initialPos(ref, draggedEl, contRef);\r\n    addEmpty(ref, draggedIndex, draggedEl, list);\r\n    setList(list.filter((r) => r !== draggedEl));\r\n    draggedEl['mouseDown'] = mouseDown;\r\n    setDraggedElement(draggedEl);\r\n  };\r\n\r\n  return (\r\n    <div style={{ display: 'flex' }}>\r\n      {list && (\r\n        <div ref={parent} className={containerclassName}>\r\n          {list.map((l) => {\r\n            return (\r\n              <div\r\n                ref={l.ref}\r\n                className={elementclassName}\r\n                key={l._id}\r\n                onMouseDown={(evt) => handleDrag(evt, l.ref)}\r\n                style={l.extraStyle ? { ...l.extraStyle } : {}}\r\n              >\r\n                {l.renderMethod}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n      {draggedElement && (\r\n        <div\r\n          className=\"dashboardContainer\"\r\n          ref={draggedElement.ref}\r\n          style={{\r\n            position: 'absolute',\r\n            ...draggedElement.extraStyle,\r\n            transform: 'translate(' + draggedElement.x + 'px,' + draggedElement.y + 'px)',\r\n            zIndex: '10000',\r\n          }}\r\n        >\r\n          {draggedElement.renderMethod}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["moveElements","draggedElement","setDraggedElement","list","setList","draggedIndex","i","Object","assign","elements","splice","isInside","ref","el","_el$ref","coords","current","getBoundingClientRect","refCoords","middleY","y","height","middleX","x","width","elCoords","bottom","inside","setTemp","setTimeout","_ref","duration","list_","contRef","elementclassName","containerclassName","useState","undefined","parent","enableAnimations","useAutoAnimate","useEffect","createElementReferences","length","map","l","createRef","handleMouseMove","evt","moveElement","style","transform","pageX","mouseDown","pageY","moveEmptyElement","handleMouseUp","handleDrop","findIndex","_id","document","removeEventListener","addEventListener","draggedEl","find","dragged","enable","newList","filter","rd","h","display","className","key","onMouseDown","stopPropagation","initialPos","coordsCont","addEmpty","extraStyle","offsetWidth","offsetHeight","r","Promise","resolve","e","reject","handleDrag","renderMethod","position","zIndex"],"mappings":"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"}